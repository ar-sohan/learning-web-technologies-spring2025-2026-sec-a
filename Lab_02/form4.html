<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Form 4</title>
    <style>
      .failed {
        color: red;
        font-size: 14px;
        margin-top: 20px;
      }
      .successful {
        color: green;
        font-size: 14px;
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <section style="padding-left: 40px; padding-top: 30px">
      <form id="form" action="">
        <fieldset style="width: fit-content">
          <legend style="font-size: large; font-weight: 600">
            Date of Birth
          </legend>
          <div style="display: flex; text-align: center;">
            <div>
              <label for="day">dd</label>
              <br />
              <input type="text" id="day" />
            </div>
            <p style="padding-left: 30px; padding-right: 30px">/</p>
            <div>
              <label for="month">mm</label>
              <br />
              <input type="text" id="month" />
            </div>
            <p style="padding-left: 30px; padding-right: 30px">/</p>
            <div>
              <label for="year">yyyy</label>
              <br />
              <input type="text" id="year" />
            </div>
          </div>
          <br><br>
          <hr>
          <br /><br />
          <input type="submit" value="Submit">
        </fieldset>
      </form>
      <p id="msg"></p>
    </section>

    <script>
      const form = document.getElementById('form');
      const message = document.getElementById('msg');
      const dayInput = document.getElementById('day');
      const monthInput = document.getElementById('month');
      const yearInput = document.getElementById('year');

      form.addEventListener('submit', function(event) {
        event.preventDefault();
        
        const day = dayInput.value.trim();
        const month = monthInput.value.trim();
        const year = yearInput.value.trim();
        
        const validationResult = validateDateOfBirth(day, month, year);
        
        if (validationResult.flag) {
          message.className = 'successful';
          message.textContent = 'Valid date of birth!';
        } else {
          message.className = 'failed';
          message.textContent = validationResult.errorText;
        }
      });

      function validateDateOfBirth(day, month, year) {
        if (day.length === 0) {
          return {
            flag: false,
            errorText: 'Day cannot be empty',
          };
        }
        if (month.length === 0) {
          return {
            flag: false,
            errorText: 'Month cannot be empty',
          };
        }
        if (year.length === 0) {
          return {
            flag: false,
            errorText: 'Year cannot be empty',
          };
        }

        if (isNaN(day) || isNaN(month) || isNaN(year)) {
          return {
            flag: false,
            errorText: 'Please enter valid numbers',
          };
        }

        const dayNum = parseInt(day, 10);
        const monthNum = parseInt(month, 10);
        const yearNum = parseInt(year, 10);

        if (dayNum < 1 || dayNum > 31) {
          return {
            flag: false,
            errorText: 'Day must be between 1 and 31',
          };
        }

        if (monthNum < 1 || monthNum > 12) {
          return {
            flag: false,
            errorText: 'Month must be between 1 and 12',
          };
        }

        if (yearNum < 1900 || yearNum > 2500) {
          return {
            flag: false,
            errorText: 'Year must be between 1900 and 2500',
          };
        }

        const daysInMonth = getDaysInMonth(monthNum, yearNum);
        if (dayNum > daysInMonth) {
          return {
            flag: false,
            errorText: `Month ${monthNum} only has ${daysInMonth} days`,
          };
        }

        return {
          flag: true,
          errorText: null
        };
      }

      function getDaysInMonth(month, year) {
        if (month === 2) {
          return isLeapYear(year) ? 29 : 28;
        }
        if ([4, 6, 9, 11].includes(month)) {
          return 30;
        }
        return 31;
      }

      function isLeapYear(year) {
        return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);
      }
    </script>
  </body>
</html>